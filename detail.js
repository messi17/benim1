var player_id="playerLiveTv",player_language="digiturk",player_streams=[],player_stream,isPlayedJwPlayer=!1,ModelMultiplay,offerPrice,offerScreen,offerDetail,offerDetailMessage,matchDetailBtn,matchPlayerWrapper,smsRequired,stepOne,stepTwo,stepOneClick,stepTwoClick,offerTimer,offerId,offerPackage,confirmationInput,blackOutScreen,blackOutMessage,nextAction,cmsContentId,usageSpecId,rfsIdToBlackout,blackOutServiceAccountId,eventStartTime,eventEndTime,adUrl,returnBlackOut,hasBlackOut=!1,channelId,autoPlay=!1,CompetitionSliderViewModel,PlayerModel;$(function(){var t=new CompetitionSliderViewModel,n;t.init();n=new PlayerModel;n.init();ModelMultiplay=new MultiplayViewModel;ModelMultiplay.init()});CompetitionSliderViewModel=function(){var n=this;n.init=function(){var n=$(".slider-comp"),i=$(".competition-week-slider"),t;n.length?(t=new Swiper(n,{slidesPerView:1,slidesPerGroup:1,centeredSlides:!1,spaceBetween:10,autoHeight:!0,navigation:{nextEl:"#js-prev-comp",prevEl:"#js-next-comp"},breakpoints:{1198:{slidesPerView:4,slidesPerGroup:4,spaceBetween:20},1024:{slidesPerView:3,slidesPerGroup:3,spaceBetween:30},992:{slidesPerView:2,slidesPerGroup:2,spaceBetween:30},520:{slidesPerView:1,slidesPerGroup:1,spaceBetween:10}}}),n.parents(".competition-week-slider").removeClass("d-none").siblings(".s-temp").addClass("d-none"),t.update()):n.parents(".competition-week-slider").removeClass("d-none").siblings(".s-temp").remove()}};PlayerModel=function(){function e(n,t,i){var r={cmsContentId:n,usageSpecId:t,adUrl:i};ViewHelper.showLoading();ViewHelper.showOverlay();$.post("/content/playrequestblackout",r,function(n){ViewHelper.hideLoading();ViewHelper.hideOverlay();var t=n.model;blackOutMessage.text(t.Message);matchDetailBtn.addClass("d-none");blackOutScreen.removeClass("d-none");hasBlackOut=n.model.HasBlackOut})}function t(t,i,r){var u={cmsContentId:t,usageSpecId:i,adUrl:r};ViewHelper.showLoading();ViewHelper.showOverlay();$.post("/content/playrequestlivesports",AddAntiForgery(u),function(t){if(ViewHelper.hideLoading(),ViewHelper.hideOverlay(),t.status===!1){$(".match-detail-error-message").removeClass("d-none").html(t.ErrorMessage);return}var i=t.model.Data.model;i.StreamToPlay!=null&&(i.Blackout.HasBlackout&&i.Blackout.HasRightToCancel||returnBlackOut.remove(),player_stream=null,player_streams=[],n.activeStreamToPlay=null,n.activeStreams=null,n.activeCdnType=-1,n.activePlayerType=-1,n.activeStreamId="",isDrm=i.StreamToPlay.IsDrm,n.StreamFormat=i.StreamToPlay.StreamFormat,n.DrmType=i.DrmType,n.CastleBlackToken=i.CastleBlackToken,n.DrmTicket=i.DrmTicket,n.activeStreamToPlay=i.StreamToPlay,n.activeCdnType=n.activeStreamToPlay.CdnType,n.activeStreams=i.Streams,n.user=i.User,n.serverTicks=i.ServerTicks,n.play(null,null))})}function i(t,i){var o,h,u,s,e,f,c,l;if(BrowserDetect.isSafariAndMobile()&&isDrm){PopupMessage.Pop("form-info",PopUpTitle.Warning,ViewHelper.MobilIosSafariMessage,PopUpFooterButton.Ok);return}if(o=!0,i&&!isNullOrUndefined(wrapper)&&(h=(new Date).getTime()-i,bitmovinAssetChangeTime=-h/1e3,!changeAsset)){wrapper.setTimeShift(bitmovinAssetChangeTime);ModelTvGuideSlider.seekSlider(i);o=!1;return}wrapper=new BitmovinPlayer;u=wrapper.streamType.NONE;switch(n.StreamFormat){case StreamType.HLS:u=wrapper.streamType.HLS;break;case StreamType.SmoothStream:u=wrapper.streamType.SmoothStream;break;case StreamType.DASH:u=wrapper.streamType.DASH}if(s={file:n.activeStreamToPlay.Url,streamType:u},isDrm){e=wrapper.licenseType.NONE;t===PlayerLisenceType.CastleBlack?e=wrapper.licenseType.CASTLEBLACK:t===PlayerLisenceType.ErStream&&(e=wrapper.licenseType.ERSTREAM);f=wrapper.drmType.None;switch(n.DrmType){case DrmType.PlayReady:f=wrapper.drmType.Playready;break;case DrmType.FairPlay:f=wrapper.drmType.Fairplay;break;case DrmType.Widevine:f=wrapper.drmType.Widevine}c={version:"1.0",withCredentials:!1,maxLicenseRequestRetries:10,licenseRequestRetryDelay:1e3,token:n.CastleBlackToken,ticket:n.DrmTicket!=null?n.DrmTicket.replace("ticket=",""):null,contentId:n.activeStreamToPlay.StreamId,licensetype:e,drmType:f};s.drm=c}l={player:{key:bitMovinPlayerKey,container:"playerLiveTvBitmovin",width:n.playerWidth,height:n.playerHeight,autoplay:!0,showspeed:!1},events:{onPlay:function(){channelCdnChanged?tvPlayersEventHelper.play():(channelCdnChanged=!1,isResume?tvPlayersEventHelper.resume(wrapper.getTimeShift()):tvPlayersEventHelper.play());bitmovinAssetChangeTime&&bitmovinAssetChangeTime<0&&(changeAsset||isDrm===!1)&&(bitmovinAssetChangeTime>-5&&(bitmovinAssetChangeTime=0),wrapper.setTimeShift(bitmovinAssetChangeTime))},onError:function(n){tvPlayersEventHelper.error(n.code,n.message)},onReady:function(){BrowserDetect.is(BrowserDetect.engine.Chrome)&&ViewHelper.ShowChromeMessage&&PopupMessage.Pop("form-info",PopUpTitle.Warning,ViewHelper.ChromeMessage,PopUpFooterButton.Ok)},onStop:function(){tvPlayersEventHelper.stop()},onPaused:function(){channelCdnChanged?(isResume=!1,channelCdnChanged=!1):tvPlayersEventHelper.pause()},onSeek:function(){},onSeeked:function(){},onTimeShift:function(){bitmovinAssetChangeTime=changeAsset?wrapper.getTimeShift():0},onTimeShifted:function(){if(o){tvPlayersEventHelper.shift(wrapper.getTimeShift());var n=calculateTimeForPlayers(parseInt(wrapper.getTimeShift()),PlayerType.Bitmovin);ModelTvGuideSlider.seekSlider(n)}},onSourceLoaded:function(){r();setActiveItem(!0);var n=$(".player-poster");n.remove()}},source:s};wrapper.Setup(l,isDrm)}function r(){switch(n.activePlayerType){case PlayerType.Bitmovin:$("#playerLiveTvBitmovin").show();$("#playerLiveTv").hide();$("#jwPlayerContainer").hide();isPlayedJwPlayer&&jwplayer().stop();break;case PlayerType.JwPlayer:$("#jwPlayerContainer").show();$("#playerLiveTv").hide();$("#playerLiveTvBitmovin").hide();isNullOrUndefined(wrapper)||wrapper.unLoad();break;default:$("#playerLiveTv").show();$("#jwPlayerContainer").hide();isPlayedJwPlayer&&jwplayer().stop();$("#playerLiveTvBitmovin").hide();isNullOrUndefined(wrapper)||wrapper.unLoad()}}function o(n){ViewHelper.showLoading();ViewHelper.showOverlay();$.ajax({type:"POST",url:"/order/OfferSalesFormLiveSports",data:AddAntiForgeryToken({orderAction:3,offerId:n})}).done(function(n){if(ViewHelper.hideLoading(),ViewHelper.hideOverlay(),n.IsBb){localStorage.setItem(".nextact",n.NextSection);window.location="/satinal";return}smsRequired=n.VerificationRequired;matchDetailBtn.addClass("d-none");offerDetail.text(n.Offers[0].Name);offerDetailMessage.text(n.Message);offerPrice.text(n.Offers[0].Price);offerPackage=n.Offers[0].OfferId;offerScreen.removeClass("d-none")})}function s(){stepOne.addClass("d-none");stepTwo.removeClass("d-none");ViewHelper.showLoading();ViewHelper.showOverlay();$.ajax({type:"POST",url:"/order/sendverificationprocessoffer",data:AddAntiForgeryToken({offerId:offerPackage,smsVerification:3})}).done(function(n){ViewHelper.hideLoading();ViewHelper.hideOverlay();switch(n.status){case 1:$(".alert-message-match-detail").html("");f(n.keyDuration);stepTwoClick.click(function(){u(confirmationInput)&&(ViewHelper.showLoading(),ViewHelper.showOverlay(),$.ajax({type:"POST",url:"/account/VerificationCode",data:AddAntiForgeryToken({code:confirmationInput.val(),captcha:null,verificationFor:1,verificationForVersion:!0})}).done(function(n){ViewHelper.hideLoading();ViewHelper.hideOverlay();switch(n.status){case 1:offerScreen.addClass("d-none");stepOne.addClass("d-none");stepTwo.addClass("d-none");matchDetailBtn.addClass("d-none");ViewHelper.showLoading();ViewHelper.showOverlay();setTimeout(function(){ViewHelper.hideLoading();ViewHelper.hideOverlay();t(cmsContentId,usageSpecId,adUrl)},3e3);break;default:$(".alert-message-match-detail").html("");$(".alert-message-match-detail").html(n.model.FormResult)}}))});break;case-1:$(".alert-message-match-detail").html("");$(".alert-message-match-detail").html(n.message);$(".offer-duration").html()===""&&$(".resend-section").removeClass("d-none")}})}function u(n){var t=!1,i=ValidationHelper.IsNullOrEmptyString(n.val())===!1;return i?(t=!0,$(".verification-error").addClass("d-none")):(t=!1,$(".verification-error").removeClass("d-none")),t}function h(){$.ajax({type:"POST",url:"/order/ProcessOffer",data:AddAntiForgeryToken({offerId:offerId})}).done(function(n){switch(n.status){case 1:stepOne.addClass("d-none");stepTwo.addClass("d-none");matchDetailBtn.addClass("d-none");t(cmsContentId,usageSpecId,adUrl);break;default:$(".alert-message-match-detail").html("");$(".alert-message-match-detail").html(n.message)}})}function f(n){var t=stepTwo.find(".offer-duration");offerTimer==null?(offerTimer=new Timer,offerTimer.addEventListener("secondsUpdated",function(){var n=offerTimer.getTotalTimeValues().seconds;n===0&&($(".resend-section").removeClass("d-none"),$(".confirmation-text").addClass("d-none"),$(".verification-error").removeClass("d-none"),$(".alert-message-match-detail").addClass("d-none"),stepTwoClick.addClass("d-none"));t.html(offerTimer.getTimeValues().toString(["minutes","seconds"]))}),offerTimer.start({countdown:!0,startValues:{minutes:0,seconds:n}})):offerTimer.reset()}var n=this;n.playerWidth=840;n.playerHeight=520;n.init=function(){returnBlackOut=$(".return-blackout");matchDetailBtn=$(".match-detail-button");nextAction=$(".match-detail-button").attr("data-next-action");autoPlay=$(".match-detail-button").attr("data-auto-play");cmsContentId=$(".match-detail-button").attr("data-cms-content-id");usageSpecId=$(".match-detail-button").attr("data-usage-spec-id");rfsIdToBlackout=$(".match-detail-button").attr("data-rfs-id");blackOutServiceAccountId=$(".match-detail-button").attr("data-blackOut-service-account-id");eventStartTime=$(".match-detail-button").attr("data-event-start-time");eventEndTime=$(".match-detail-button").attr("data-event-end-time");adUrl=$(".match-detail-button").attr("data-ad-url");offerId=$(".match-detail-button").attr("data-offer-id");channelId=$(".match-detail-button").attr("data-channeld-id");offerScreen=$(".offer-screen");blackOutScreen=$(".broadcasting-warning");blackOutMessage=blackOutScreen.find(".blackout-message");matchPlayerWrapper=$(".match-player-wrapper");offerPrice=offerScreen.find(".member-price");offerDetail=offerScreen.find(".offer-detail");offerDetailMessage=offerScreen.find(".offer-detail-message");stepOne=$(".step-one");stepTwo=$(".step-two");stepOneClick=$(".step-one-click");stepTwoClick=$(".step-two-click");confirmationInput=stepTwo.find(".confirmation-input");matchDetailBtn.click(function(){switch(nextAction){case"Play":t(cmsContentId,usageSpecId,adUrl);break;case"Offer":o(offerId);break;case"BlackoutRequest":e(cmsContentId,usageSpecId,adUrl)}});stepOneClick.click(function(){smsRequired===!0?s():h()});matchPlayerWrapper.mouseover(function(){returnBlackOut.css({visibility:"visible"})});matchPlayerWrapper.mouseout(function(){returnBlackOut.css({visibility:"hidden"})});nextAction=="Play"&&autoPlay=="True"&&matchDetailBtn.trigger("click")};n.play=function(t,u){if(ModelMultiplay.checkMultiplay(player_id),matchDetailBtn.hide(),matchPlayerWrapper.removeClass("d-none"),returnBlackOut.css({visibility:"visible"}),isDrm===!1){switch(n.activeCdnType){case CdnType.Octoshape:if(u){var f=(new Date).getTime()-u;octoshapeAssetChangeTime=f}n.activePlayerType=PlayerType.OctoShape;switch(n.activeViewMode){case n.ViewModes.LiveTv:player_backgroundImage=isRadio?contentCDNUrl+"/Assets/images/default-tv.png":"";activeMode=n.ViewModes.LiveTv;player_streams=n.fillStreamsForOctoshape(n.activeStreams,null,channelId,null,n.StreamFormat);break;case n.ViewModes.LiveSport:activeMode=n.ViewModes.LiveSport;player_streams=n.fillStreamsForOctoshape(n.activeStreams,usageSpecId,null,cmsContentId,n.StreamFormat)}if(t?(player_stream=t,n.activeStreamId=player_stream):n.activeStreamId||(player_stream=n.activeStreamToPlay.StreamId,n.activeStreamId=player_stream),isResume=!1,n.playerReady==!1)swfobject.embedSWF(document.location.protocol+"//octoshape-a.akamaihd.net/eps/players/infinitehd4/player.swf",player_id,n.playerWidth,n.playerHeight,"10.2.0",null,null,n.playerParams,n.playerAttributes),setActiveItem(!0);else if(u)try{n.player.os_load(player_stream,u);setActiveItem(!0)}catch(e){setActiveItem();return}else try{n.player.os_load(player_stream);setActiveItem()}catch(e){Log(1,e);setActiveItem();return}break;default:n.activePlayerType=PlayerType.Bitmovin;i(null,u)}r()}else{n.activePlayerType=PlayerType.Bitmovin;switch(n.DrmType){case DrmType.Widevine:i(PlayerLisenceType.ErStream,u);break;case DrmType.FairPlay:i(PlayerLisenceType.CastleBlack,u);break;case DrmType.PlayReady:i(PlayerLisenceType.ErStream,u)}r()}};$(".broadcast-cancel").click(function(){matchDetailBtn.removeClass("d-none");blackOutScreen.addClass("d-none")});$(".broadcast-request").click(function(){ViewHelper.showLoading();ViewHelper.showOverlay();var n={usageSpecId:usageSpecId,channelId:channelId,eventStartTime:eventStartTime,eventEndTime:eventEndTime,rfsIdToBlackout:rfsIdToBlackout,serviceAccountId:blackOutServiceAccountId};$.post("/content/ActivateBlackOut",AddAntiForgeryToken(n),function(){ViewHelper.hideLoading();ViewHelper.hideOverlay();matchDetailBtn.addClass("d-none");blackOutScreen.addClass("d-none");t(cmsContentId,usageSpecId,adUrl)})});$(".resend-section").click(function(){ViewHelper.showLoading();ViewHelper.showOverlay();$.ajax({type:"POST",url:"/Account/ReSendVerificationCode",data:AddAntiForgeryToken({smsVerification:2})}).done(function(n){if(ViewHelper.hideLoading(),ViewHelper.hideOverlay(),n!=null){if(n.status){$(".resend-section").addClass("d-none");$(".confirmation-text").removeClass("d-none");$(".verification-code").removeClass("d-none");stepTwoClick.removeClass("d-none");stepTwoClick.click(function(){u(confirmationInput)&&(ViewHelper.showLoading(),ViewHelper.showOverlay(),$.ajax({type:"POST",url:"/account/VerificationCode",data:AddAntiForgeryToken({code:confirmationInput.val(),captcha:null,verificationFor:1,verificationForVersion:!0})}).done(function(n){ViewHelper.hideLoading();ViewHelper.hideOverlay();switch(n.status){case 1:offerScreen.addClass("d-none");stepOne.addClass("d-none");stepTwo.addClass("d-none");matchDetailBtn.addClass("d-none");t(cmsContentId,usageSpecId,adUrl);break;default:$(".alert-message-match-detail").html("");$(".alert-message-match-detail").html(n.model.FormResult)}}))});f(n.keyDuration);return}n.NeedLogin?window.location=response.LoginUrl:($(".alert-message-match-detail").html(""),$(".alert-message-match-detail").html(result.message))}})});$(".return-blackout").click(function(){$.post("/Tv/BlackoutCancel",AddAntiForgery({usageSpecId:usageSpecId,channelId:channelId}),function(n){$(".blackout-cancel-text").removeClass("d-none").find(".package__text span").html(n.Message);$("html, body").animate({scrollTop:$(".blackout-cancel-text").offset().top-200},800);$(".match-player-wrapper").find(".return-blackout").addClass("d-none")})});$(".match-return-back-offer").click(function(){stepOne.removeClass("d-none");stepTwo.addClass("d-none");$(".verification-error").addClass("d-none")})}
