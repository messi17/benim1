var QosProvider=function(){var n=this,u=ClientQos||"https://qos.ercdn.com/qos/latency/",f="?publicKey="+UesKey+"&immediately",e="?publicKey="+UesKey+"&immediately",t,i,r;this.token="";t="desktop";jscd.mobile&&(t="mobile");i={ip:"0",app:jscd.browser,device:t,medium:"browser",os:jscd.os,sessionID:SessionId,srWidth:$(window).width(),srHeight:$(window).height()};this.formDataToken={};this.GetUesToken=function(){return n.token=utoken,localStorage.setItem("u_tkn",utoken),utoken};this.SendLatency=function(t,r){var o=f,s,h,c;return t&&(o=e),h=Object.assign({},n.formDataToken,i,r),c=u+"latency/"+o+"&token="+n.token,$.ajax({type:"POST",url:c,data:JSON.stringify(h),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){s=n},failure:function(){}}),s};r=function(){n.formDataToken={token:utoken,sessionID:SessionId}};r()},qos;AuthCheck&&(qos=new QosProvider);var dataTravelerIndex=$("#hiddenDataTravelerIndex"),itemId=dataTravelerIndex.attr("itemId"),NextEpisodeCheck=dataTravelerIndex.attr("NextEpisodeCheck"),HaveNextEpisode=dataTravelerIndex.attr("HaveNextEpisode"),DetailUrl=dataTravelerIndex.attr("DetailUrl"),CategoryID=dataTravelerIndex.attr("CategoryID"),CategoryName=dataTravelerIndex.attr("CategoryName"),CheckQosUser=dataTravelerIndex.attr("CheckQosUser"),CheckPin=dataTravelerIndex.attr("CheckPin"),sessionID=dataTravelerIndex.attr("sessionID"),userId=dataTravelerIndex.attr("userId"),contentData=GetItemDetails(itemId),playerModule=function(){function ot(){var i=contentData.subtitleUrls,t=[];return i!=null&&i.length>0&&i.forEach(function(i){var r=i.subtitleUrl.replace("http://","https://");i.subtitleUrl.indexOf(".srt")!=-1?$.get(r,function(){}).done(function(r){const u=window.Subtitle.parse(r),f=window.Subtitle.stringifyVtt(u);var e=new Blob([f],{type:"text/vtt"}),o=URL.createObjectURL(e),s=localR.GetValueFromLangKeyList("Player_Lang_"+i.subtitleName);t.push([i.subtitleName,s,o]);n.setCaptionsList(t)}):t.push([i.subtitleName,i.subtitleName,r])}),t}function rt(n,t){return n===null?n:(n=n.replace("http://","https://"),t==="mpd")?(n=n.replace("playlist.m3u8","manifest_mpm4sav_mvlist.mpd"),sourceType="mpd",n+f):(sourceType="hls",n.replace("&amp;e","&e")+f)}function st(){var n=$("#hiddenDataTraveler");u=n.attr("nextEpisodeId");e=n.attr("name");y=n.attr("licenseKey");c=n.attr("isAds");p=n.attr("adsUrl");w=n.attr("isDrm");o=n.attr("drmTicket");b=n.attr("autoUrl");k=n.attr("HlsUrl");d=n.attr("DashUrl");et.InıtPlayer()}function ht(n){var t=n/1e3,r=parseInt(t/3600),i;return t=t%3600,i=parseInt(t/60),t=t%60,(r>0?r+":":"")+(i<10?"0":"")+i+":"+(t<10?"0":"")+t.toFixed(0)}function ct(){if(!nt&&(nt=!0,ga("send","event","VODPlayer","ended",e),"episode"==CategoryName)){var t=function(){if(NextEpisodeCheck=="True"&&HaveNextEpisode=="True"){$("#CountDownContainer").css("display","block");$(".next-episode").css("display","block");var n=15;g=setInterval(function(){document.getElementById("countdown").innerHTML=n;n-=1;n<=0&&(clearInterval(g),window.location.href=$("#next-episode-link").attr("href"))},1e3)}else setTimeout(function(){window.history.back()},15e3)};$.get(ClientCms+"/api/getAssetId?itemid="+u,function(i){u=i;var r={contentID:u,containerID:s,position:0,duration:0,contentDuration:Math.floor(n.getDuration()/1e3)};ues.AddToHistory(contentData,r,t)})}}function lt(){var t=n.getDuration()-n.getCurrentTime();n.getCurrentTime()>3e4&&t<15e3&&ct();$(".rmp-remaining-time").html(ht(t))}function at(){var i="desktop",n,t;if(jscd.mobile&&(i="mobile"),f+="&c="+jscd.browser+"&d="+i+"&p=browser&t="+contentData.encodedURL,n={licenseKey:y,googleCast:!1,width:$(window).width(),height:$(window).height(),autoplay:!0,pip:!1,contentMetadata:{title:e},hideSeekBar:!1,skin:"s3",pathToRmpFiles:"/js/lib/radiantmediaplayer-5.11.3/",ccFiles:null},info=getUrlParameter("up"),info!=null&&(n.offsetStartPosition=Math.floor(info*1e3)),c){try{}catch(r){}n.ads=!0;n.labels={ads:{controlBarCustomMessage:"Ads"}};n.adTagUrl=p;n.adBlockerDetection=!0;n.adBlockerDetectedPreventPlayback=!0}return w?browserDedect()==="safari"?(n.forceHlsJSOnMacOSSafari=!0,n.src={fps:rt(k,"hls")},n.fpsDrm={certificatePath:"https://drm.ercdn.com/exxen/fp/api/Certificate/GetCert/?"+o,processSpcPath:"https://drm.ercdn.com/exxen/fp/api/Fairplay/GetRadiantLicense/?"+o+"&reqType=1",certificateRequestHeaders:[],licenseResponseType:"text",licenseRequestMessage:function(n){return base64EncodeUint8Array(n)}}):(n.src={dash:rt(d,"mpd")},n.shakaDrm={servers:{"com.widevine.alpha":"https://wv-proxy.ercdn.com/api/erproxy"}},n.shakaRequestConfiguration={license:{headers:{"X-ErDrm-Message":o}}}):(t=b,t=t.replace("amp;",""),t.indexOf("?")!=-1&&(f=f.replace("?","&")),n.src={hls:t+f}),n}function v(){var f,t,u,e,o;if(!it){it=!0;var r=contentData.subtitleUrls,s=$(".captions-off").closest(".rmp-overlay-levels-area"),h=n.getAudioTracks()!=null?n.getAudioTracks():[];typeof r!="undefined"&&r.length!=0&&($("#Captions").append(s),$("#CaptionSection").css("display","block"));(typeof r!="undefined"&&r.length>0||h.length>1)&&$(".rmp-info-box").addClass("display-block");$("#CaptionSection .rmp-overlay-levels-area").length>1&&($($("#CaptionSection .rmp-overlay-levels-area")).css("display","none"),$($("#CaptionSection .rmp-overlay-levels-area")[1]).addClass("display-block"));$("#CaptionSection .rmp-overlay-level").on("click touchstart",function(){$("#CaptionSection .rmp-overlay-level").removeClass("rmp-overlay-level-active");$(this).addClass("rmp-overlay-level-active")});try{for(f=document.getElementById("Captions").children[0],i=0;i<f.children.length;i++)t=f.children[i],u="captions-",t.className.indexOf(u)>-1&&(e=t.className.indexOf(u)+u.length,t.className.indexOf(" ")>-1&&(o=t.className.indexOf(" "),t.innerText=localR.GetValueFromLangKeyList("Player_Lang_"+t.className.substring(e,o))))}catch(c){}}}function ut(){try{n.setFullscreen(!0)}catch(t){}}function ft(){try{n.setFullscreen(!1)}catch(t){}}var et=this,t=$("#hiddenDataTraveler"),u=t.attr("nextEpisodeId"),e=t.attr("name"),y=t.attr("licenseKey"),c=t.attr("isAds"),p=t.attr("adsUrl"),w=t.attr("isDrm"),o=t.attr("drmTicket"),b=t.attr("autoUrl"),k=t.attr("HlsUrl"),d=t.attr("DashUrl"),f="?sid="+sessionID+"&uid="+userId+"&ct="+CategoryName;NextEpisodeCheck!=="False"&&(request={Categories:[CategoryID],ContentTypes:[1],CustomSortField:"episode_number",SortDirection:"ASC",SortType:"Custom",PageIndex:0,PageSize:20});var n,g,s,l=!0,nt=!1,a=!1,r=undefined,tt=!1,h=!1,it=!1;this.ClearPlayer=function(t){n.pause();ShowLoading();$("#rmpPlayer").css({opacity:"0",visibility:"hidden"});window.location.href=t};this.RemovePlayer=function(){n.pause();n.resize();$("#rmpPlayer").css("display","none")};this.CheckPinLoadPlayer=function(){var i;ShowLoading();var r=$(".code-character"),n="",t=!0;return r.each(function(){n+=$(this).val();$(this).val()===""&&(t=!1)}),t&&n.length===4?(i={pin:n,id:itemId,containerId:parentId},event.stopPropagation(),event.preventDefault(),$("#PassForm").css("display","none"),$.ajax({url:"/"+ln+"/Watch/CreatePlayerView",type:"POST",data:i,success:function(n){n==="PinError"?(HideLoading(),$("#pinControlPopup .validation-summary-errors").css("display","block"),$(".code-character").val("")):(ClearPopup("pinControlPopup"),ShowLoading(),$("#PartialViewPlayerBox").html(n),st(),HideLoading())},fail:function(){$("#errorForm").css("display","block")}}),!1):void 0};this.InıtPlayer=function(){var i,f;if(browserDedect()!=="iexplorer"){var y=at(),o="rmpPlayer",t=document.getElementById(o);if(t.addEventListener("ready",function(){ot();s=contentData.id;"serie"==CategoryName&&$.get(ClientCms+"/api/getAssetId?itemid="+u,function(n){u=n});contentData.id!=parentId&&$.get(ClientCms+"/api/getAssetId?itemid="+parentId,function(n){s=n});$(".rmp-info-box").css("display","none");n.setVolume(1);playerReadyTime=new Date;$(".rmp-volume").css("display")=="block"&&$(".rmp-desktop-volume-icon-2").css("display","none");$(".rmp-control-bar").append($(".rmp-remaining-time"));$(".rmp-desktop-volume-icon-2 .volume-icon").on("click",function(){n.getMute()?($(".rmp-desktop-volume-icon-2").addClass("rmp-i-volume"),$(".rmp-desktop-volume-icon-2").removeClass("rmp-i-off-volume"),$("input[type=range]").val(100)):($(".rmp-desktop-volume-icon-2").addClass("rmp-i-off-volume"),$(".rmp-desktop-volume-icon-2").removeClass("rmp-i-volume"),$("input[type=range]").val(0));n.setMute(!n.getMute())});$("input[type=range]").on("input",function(){n.setVolume($(this).val()/100);$(this).val()<10?($(".rmp-desktop-volume-icon-2").addClass("rmp-i-off-volume"),$(".rmp-desktop-volume-icon-2").removeClass("rmp-i-volume")):($(".rmp-desktop-volume-icon-2").addClass("rmp-i-volume"),$(".rmp-desktop-volume-icon-2").removeClass("rmp-i-off-volume"))});$(".player-inner .left-buttons").append($(".rmp-i-volume.rmp-desktop-volume-icon-2"));$(".rmp-i-volume.rmp-desktop-volume-icon-2").addClass("player-button");$(".player-inner .left-buttons").append($(".rmp-desktop-volume-icon"));$(".rmp-desktop-volume-icon").addClass("player-button");$(".rmp-fullscreen").addClass("player-button");$(".rmp-control-bar").append($(".player-inner"));$(".rmp-control-bar").append($(".player-name-container"));$(".rmp-control-bar").append($(".smart-sign-parent"));$(".player-inner .left-buttons").prepend($(".rmp-play-pause"));$(".rmp-play-pause").addClass("player-button");$(".player-inner .left-buttons").append($(".rmp-volume.rmp-module"));$(".rmp-volume.rmp-module").addClass("player-button");$(".rmp-captions").addClass("display-none");$(".rmp-audio").addClass("display-none");$(".rmp-indicator").append("<span class='rmp-indicator-inner-span'><\/span>");$(".close-button").on("touchstart",function(){window.history.back()});$(".rpm-prev-10").on("click touchstart",function(){n.seekTo(n.getCurrentTime()-3e4)});$(".rpm-next-10").on("click touchstart",function(){n.seekTo(n.getCurrentTime()+3e4)});$(".rpm-next-episode").on("click touchstart",function(){$(".next-episode").toggle();var n=$(".diger-bolumler").css("display");n=="block"&&$(".diger-bolumler").hide()});$(".rmp-info-box").on("click touchstart",function(){$(".info-box-all").toggle();var n=$(".info-box-all").css("display");n.indexOf("block")!=-1?$("#rmpPlayer .rmp-info-box").css("background-image","url(/img/rmp-subtitle-lang-close.png)"):$("#rmpPlayer .rmp-info-box").css("background-image","url(/img/rmp-subtitle-lang.png)")});var t=0;setInterval(function(){lt();var i=n.getPaused(),r=n.getReady();!i&&r&&t++},1e3);setInterval(function(){if(t!=0){var i={contentID:contentData.assetId,containerID:s,position:Math.floor(n.getCurrentTime()/1e3),duration:t,contentDuration:Math.floor(n.getDuration()/1e3)};console.log(contentData);ues.CreateSession(!1,contentData,i);t=0}},1e4);$("#rmpPlayer .rmp-i-pause::before").css("content","");$("div#playerContainer:after").css("display","none")}),c&&(t.addEventListener("adloaded",function(){}),t.addEventListener("adstarted",function(){try{n.getCurrentTime()<3&&(r&&clearTimeout(r),a=!0,$(".smart-sign-parent").css("display","none"))}catch(t){}}),t.addEventListener("adcomplete",function(){try{a&&($(".smart-sign-parent").css("display","block"),r&&clearTimeout(r),a=!1,setTimeout(function(){$(".smart-sign-parent").css("display","none")},5e3))}catch(n){}}),t.addEventListener("adclick",function(){}),t.addEventListener("aderror",function(){})),t.addEventListener("timeupdate",function(){var t=navigator.userAgent.toLowerCase();if(t.indexOf("safari")!=-1){if(t.indexOf("chrome")>-1){v();return}n.getCurrentTime()>1&&!tt&&(tt=!0,setTimeout(function(){v()},2e3));return}v()}),t.addEventListener("firstframe",function(){r&&clearTimeout(r);r=setTimeout(function(){$(".smart-sign-parent").css("display","none")},5e3);$(".captions-off").html("Kapalı");$(".captions-ingilizce").html("İngilizce");var t=n.getAudioTracks()!=null?n.getAudioTracks():[];typeof t!="undefined"?t.forEach(function(n,t){var i=localR.GetValueFromLangKeyList("Player_Lang_"+n.language);$("#AudioTracks").append('<div class="rmp-overlay-level rmp-color-bg" data-attr="'+t+'"   aria-label="'+n.language+'" >'+i+"<\/div>")}):$("#AudioSection").css("display","none");$("#AudioTracks .rmp-overlay-level").on("click touchstart",function(){$("#AudioTracks .rmp-overlay-level").removeClass("rmp-overlay-level-active");$(this).addClass("rmp-overlay-level-active");n.setAudioTrack(parseInt($(this).attr("data-attr")))})}),t.addEventListener("loadeddata",function(){$(".player-inner .right-buttons").prepend($(".rmp-fullscreen"));$(".rmp-fullscreen").css("display","block");document.getElementsByClassName("rmp-fullscreen")[0].addEventListener("touchstart",function(){h?ft():ut()},!1);$(".rmp-fullscreen").click(function(){h?ft():ut()})}),t.addEventListener("texttrackchanged",function(){}),t.addEventListener("enterfullscreen",function(){h=!0}),t.addEventListener("exitfullscreen",function(){h=!1}),t.addEventListener("ended",function(){var n=getCookie("pNe");n!="true"&&window.history.back();CategoryName=="movie"&&window.history.back();CategoryName=="trailer"&&(window.location.href=DetailUrl)}),t.addEventListener("pause",function(){licenseName.indexOf("RKLMVAR")!=-1&&gtag("event","pause",{event_category:"player",event_label:e})}),CheckQosUser=="True"&&(i=new Date,f=new Date,t.addEventListener("error",function(){var i=n.getErrorData(),r,e,u,f,t;i&&(r=i.event,r&&(e=i.code+"-"+r.code,u={type:"error",contentID:contentData.id,value:1,errorCode:e},typeof n!="undefined"&&(f=n.getBitrates(),f!=null&&(t=f.filter(n=>n.active==!0),t.length!=0&&t[0].bandwidth!="undefined"&&(u.bitrate=t[0].bandwidth))),qos.SendLatency(!1,u)))}),t.addEventListener("startuptimeavailable",function(){var i={type:"startup",contentID:contentData.id,value:n.startUpTime},r,t;typeof n!="undefined"&&(r=n.getBitrates(),t=r.filter(n=>n.active==!0),t.length!=0&&t[0].bandwidth!="undefined"&&(i.bitrate=t[0].bandwidth));qos.SendLatency(!1,i)}),t.addEventListener("bufferstalled",function(){i=new Date}),t.addEventListener("buffernotstalledanymore",function(){var f=new Date,e=f.getTime()-i.getTime(),r={type:"buffer",contentID:contentData.id,value:e},u,t;typeof n!="undefined"&&(u=n.getBitrates(),t=u.filter(n=>n.active==!0),t.length!=0&&t[0].bandwidth!="undefined"&&(r.bitrate=t[0].bandwidth));qos.SendLatency(!1,r)}),t.addEventListener("seeking",function(){f=new Date}),t.addEventListener("seeked",function(){var o=i=new Date,u=o.getTime()-f.getTime(),r,e,t;u>1e3&&(r={type:"seek",contentID:contentData.id,value:u},typeof n!="undefined"&&(e=n.getBitrates(),t=e.filter(n=>n.active==!0),t.length!=0&&t[0].bandwidth!="undefined"&&(r.bitrate=t[0].bandwidth)),qos.SendLatency(!1,r))})),n=new RadiantMP(o),n.init(y),n.setModuleOverlayVisible("audio",!0),NextEpisodeCheck=="True")$("#next-episode-link").on("click touchstart",function(){window.location.href=$(this).attr("href")});$(".info-box-all button.btn-continue").on("click touchstart",function(){$(".info-box-all").toggle()});$(".episodes ul li a").on("touchend click",function(){l!=!0&&(window.location.href=$(this).attr("href"))}).on("touchmove",function(){l=!0}).on("touchstart",function(){l=!1})}}},playerM=new playerModule;window.addEventListener("beforeunload",function(){var t,r,n;if(CheckQosUser=="True"&&(t=rmp.getTimeViewed(),playerReadyTime!="undefined"&&t==0)){var u=new Date,f=u.getTime()-playerReadyTime.getTime(),i={type:"abort",contentID:contentData.id,value:f};typeof rmp!="undefined"&&(r=rmp.getBitrates(),n=r.filter(n=>n.active==!0),n.length!=0&&n[0].bandwidth!="undefined"&&(i.bitrate=n[0].bandwidth));qos.SendLatency(!1,i)}});window.addEventListener("orientationchange",function(n){(n.target.screen.orientation.angle==90||n.target.screen.orientation.angle==180)&&$(".rmp-volume").css("display")=="block"&&$(".rmp-desktop-volume-icon-2").css("display","none")});$(document).ready(function(){CheckPin=="false"&&playerM.InıtPlayer(),function(){setInterval(function(){window.sessionWatchLock===!1&&(window.sessionWatchLock=!0,CreateSessionTimerWatch())},3e5)}();$(".code-character").keyup(function(){$(this).val().length==$(this).attr("maxlength")&&$(this).next(":input").focus()})});
